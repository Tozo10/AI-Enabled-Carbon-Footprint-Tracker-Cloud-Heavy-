services:
  backend:
    build: ./carbon-tracker-backend
    container_name: django-backend
    # This command runs your Django dev server
    # Make sure it's running on 0.0.0.0 to be accessible outside the container
    command: python manage.py runserver 0.0.0.0:8000
    volumes:
      - ./carbon-tracker-backend:/app # Syncs your local code with the container
    ports:
      - "8001:8000" # Maps your host port 8001 to the container's port 8000

  frontend:
    build: ./carbon-tracker-frontend
    container_name: react-frontend
    volumes:
      - ./carbon-tracker-frontend:/app # Syncs your local code
      # Prevents node_modules from being overwritten by the host
      - /app/node_modules 
    ports:
      - "3001:80" # I changed this from :80 to :3000
    environment:
      - CHOKIDAR_USEPOLLING=true # Helps with live-reloading inside Docker
    depends_on:
      - backend # Tells Docker to start the backend before the frontend